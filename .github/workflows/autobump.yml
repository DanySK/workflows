name: Autobump on push

on:
  push:
    branches:
      - master

jobs:
  autobump:
    runs-on: ubuntu-latest
    steps:
      - uses: paulhatch/semantic-version@v4.0.2
        id: version
        with:
          tag_prefix: ''
          major_pattern: '/\w+(\(\w+\))?\!:\s.+/'
          minor_pattern: '/feat(\(\w+\))?:\s.+/'
          format: "${major}.${minor}.${patch}-dev${increment}"
          bump_each_commit: true
      - name: Release
        if: matrix.os == 'ubuntu'
        uses: ncipollo/release-action@v1.10.0
        with:
          tag: ${{ steps.version.outputs.version_tag }}
          allowUpdates: true
          token: ${{ secrets.GITHUB_TOKEN }}
